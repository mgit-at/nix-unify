module shareSystemd || return

proc hook_files(; ; ctx, cfg) {
  if (cfg.enable) {
    for unit in (cfg.units) {
      maybe-link "systemd/system/$unit" (ctx)
      maybe-link "systemd/system/$unit.d" (ctx)
      # todo: get and link dependencies if not on host
    }
  }
}

proc final(; ; ctx, cfg) {
  systemctl daemon-reload
}
